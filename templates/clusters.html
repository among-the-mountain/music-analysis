{% extends "base.html" %}

{% block title %}Clusters - Music Analysis{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>ðŸŽ­ Emotion Clusters</h1>
        <p>Explore each music emotion cluster and its characteristic tracks</p>
    </div>
    
    {% for cluster in clusters %}
    <div class="cluster-detail-section">
        <div class="cluster-header">
            <div class="cluster-title">
                <h2>{{ cluster.name }}</h2>
                <span class="cluster-count">{{ cluster.count }} tracks</span>
            </div>
            <div class="cluster-features-summary">
                <div class="feature-stat">
                    <span class="feature-label">ðŸ’ƒ Danceability</span>
                    <span class="feature-value">{{ "%.2f"|format(cluster.features.danceability) }}</span>
                    <div class="feature-bar">
                        <div class="feature-bar-fill" style="width: {{ cluster.features.danceability * 100 }}%"></div>
                    </div>
                </div>
                <div class="feature-stat">
                    <span class="feature-label">âš¡ Energy</span>
                    <span class="feature-value">{{ "%.2f"|format(cluster.features.energy) }}</span>
                    <div class="feature-bar">
                        <div class="feature-bar-fill" style="width: {{ cluster.features.energy * 100 }}%"></div>
                    </div>
                </div>
                <div class="feature-stat">
                    <span class="feature-label">ðŸ˜Š Valence</span>
                    <span class="feature-value">{{ "%.2f"|format(cluster.features.valence) }}</span>
                    <div class="feature-bar">
                        <div class="feature-bar-fill" style="width: {{ cluster.features.valence * 100 }}%"></div>
                    </div>
                </div>
                <div class="feature-stat">
                    <span class="feature-label">ðŸŽ¸ Acousticness</span>
                    <span class="feature-value">{{ "%.2f"|format(cluster.features.acousticness) }}</span>
                    <div class="feature-bar">
                        <div class="feature-bar-fill" style="width: {{ cluster.features.acousticness * 100 }}%"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="cluster-content-grid">
            <div class="cluster-radar">
                <h3>Feature Profile</h3>
                {{ cluster.radar_chart|safe }}
            </div>
            
            <div class="cluster-tracks">
                <h3>Top Tracks in This Cluster</h3>
                <div class="tracks-list">
                    {% if cluster.tracks %}
                        {% for track in cluster.tracks %}
                        <div class="track-item">
                            <div class="track-rank">{{ loop.index }}</div>
                            <div class="track-info">
                                <div class="track-name">{{ track.track_name }}</div>
                                <div class="track-artist">{{ track.artists }}</div>
                            </div>
                            <div class="track-features">
                                <span class="mini-badge" title="Danceability">ðŸ’ƒ {{ "%.2f"|format(track.danceability) }}</span>
                                <span class="mini-badge" title="Energy">âš¡ {{ "%.2f"|format(track.energy) }}</span>
                                <span class="mini-badge" title="Valence">ðŸ˜Š {{ "%.2f"|format(track.valence) }}</span>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="no-tracks">No tracks available for this cluster.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}
